<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Marionette Contact Manager</title>
    <link href="./assets/css/bootstrap.css" rel="stylesheet">
    <link href="./assets/css/application.css" rel="stylesheet">
</head>

<body>

<div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <span class="brand">Contact manager</span>
        </div>
    </div>
</div>

<div id="main-region" class="container">
    <p>Here is static content in the web page. You'll notice that it gets replaced by our app as soon as we start it.</p>
</div>

<script type="text/template" id="contact-list-item">
    <%- firstName %> <%- lastName %>
</script>

<script src="./assets/js/vendor/jquery.js"></script>
<script src="./assets/js/vendor/json2.js"></script>
<script src="./assets/js/vendor/underscore.js"></script>
<script src="./assets/js/vendor/backbone.js"></script>
<script src="./assets/js/vendor/backbone.marionette.js"></script>

<script type="text/javascript">

    // Marionette app declaration
    var ContactManager = new Marionette.Application();

    // Define the html region in which we will populate the CollectionView
    ContactManager.addRegions({
        mainRegion: "#main-region"
    });

    //--------------------
    // Define and Instantiate a single Contact Model object
    ContactManager.Contact = Backbone.Model.extend({});

    // Define and Instantiate a Backbone Collection of Contact Model objects
    ContactManager.ContactCollection = Backbone.Collection.extend({ model: ContactManager.Contact }); //, comparator: "firstName" });

    //--------------------
    // Define and instantiate the view for each individual Model within a CollectionView
    ContactManager.ContactItemView = Marionette.ItemView.extend({ tagName: "li", template: "#contact-list-item" });

    // Define and Instantiate a Marionette CollectionView object
    // which contain the objects of type ContactManager.ContactItemView
    ContactManager.ContactsView = Marionette.CollectionView.extend({
        tagName: "ul",                              //surround with <ul/>, Our template is of tag type <li/>
        childView: ContactManager.ContactItemView   //itemView: ContactManager.ContactItemView (DEPRECATED: itemView)
    });

    //--------------------
    // Create On-Start method which
    // Defines the events to occur when the application starts, using our pre-defined types.
    ContactManager.on("start", function () {

        // (Model) Declare the ContactCollection objects
//        var contacts = new ContactManager.ContactCollection([
//            { firstName: "Bob", lastName: "Brigham", phoneNumber: "555-0163" },
//            { firstName: "Alice", lastName: "Arten", phoneNumber: "555-0184" },
//            { firstName: "Charlie", lastName: "Campbell", phoneNumber: "555-0129" }
//        ]);

        var contacts = new ContactManager.ContactCollection();
        contacts.comparator = "firstName";
        contacts.add(new ContactManager.Contact({ firstName: "Bob", lastName: "Brigham", phoneNumber: "555-0163" }));
        contacts.add(new ContactManager.Contact({ firstName: "Alice", lastName: "Arten", phoneNumber: "555-0184" }));
        contacts.add(new ContactManager.Contact({ firstName: "Charlie", lastName: "Campbell", phoneNumber: "555-0129" }));

        // (View) Declare the view object and populate with the model.
        var contactsListView = new ContactManager.ContactsView({ collection: contacts });

        // Place the view in the region.
        ContactManager.mainRegion.show(contactsListView);
    });

    // Call the start() method above
    ContactManager.start();
</script>
</body>
</html>
